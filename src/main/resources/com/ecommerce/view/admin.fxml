<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.ToggleButton?>
<?import javafx.scene.control.cell.PropertyValueFactory?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane prefHeight="800.0" prefWidth="1300.0" 
            xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="com.ecommerce.controller.AdminController"
            stylesheets="@../../../css/style.css"
            styleClass="admin-root">
    
    <top>
        <HBox alignment="CENTER_LEFT" spacing="25.0" styleClass="header-bar">
            <Label text="ðŸ›ï¸ TECHSHOP ADMIN" textFill="#3C50E0" styleClass="header-title">
                <font><Font name="System Bold" size="22.0" /></font>
            </Label>
            
            <HBox HBox.hgrow="ALWAYS" />
            
            <ToggleButton fx:id="btnTheme" onAction="#handleToggleTheme" text="ðŸŒ™ Cháº¿ Ä‘á»™ Tá»‘i" style="-fx-background-color: white; -fx-text-fill: #1C2434; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 8 18; -fx-font-size: 13px; -fx-border-color: #CBD5E1; -fx-border-width: 1.5; -fx-border-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.05), 4, 0, 0, 1); -fx-cursor: hand;"/>
            <Button onAction="#handleAdminProfile" text="ðŸ‘¤ Há»“ sÆ¡" style="-fx-background-color: white; -fx-text-fill: #1C2434; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 8 18; -fx-font-size: 13px; -fx-border-color: #CBD5E1; -fx-border-width: 1.5; -fx-border-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.05), 4, 0, 0, 1); -fx-cursor: hand;"/>
            <Button onAction="#handleLogout" text="ðŸšª ÄÄƒng xuáº¥t" style="-fx-background-color: #EF4444; -fx-text-fill: white; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 8 18; -fx-font-size: 13px; -fx-effect: dropshadow(three-pass-box, rgba(239, 68, 68, 0.4), 8, 0, 0, 3); -fx-cursor: hand;"/>
        </HBox>
    </top>
    
    <center>
        <TabPane tabClosingPolicy="UNAVAILABLE" styleClass="admin-tab-pane">
            
            <Tab text="ðŸ“Š Dashboard">
                <VBox spacing="25.0" styleClass="dashboard-container">
                    <Label text="ðŸ“Š Tá»•ng quan há»‡ thá»‘ng" styleClass="label-title dashboard-title"/>
                    
                    <HBox spacing="20.0" alignment="CENTER_LEFT">
                        <VBox prefWidth="300" spacing="10" styleClass="stat-card-revenue">
                            <Label text="ðŸ’° DOANH THU" styleClass="stat-label"/>
                            <Label fx:id="lblDashRevenue" text="Loading..." styleClass="stat-value"/>
                        </VBox>
                        <VBox prefWidth="280" spacing="10" styleClass="stat-card-orders">
                            <Label text="ðŸ“¦ ÄÆ N HÃ€NG" styleClass="stat-label"/>
                            <Label fx:id="lblDashOrders" text="Loading..." styleClass="stat-value"/>
                        </VBox>
                        <VBox prefWidth="280" spacing="10" styleClass="stat-card-products">
                            <Label text="ðŸ›ï¸ Sáº¢N PHáº¨M" styleClass="stat-label"/>
                            <Label fx:id="lblDashProducts" text="Loading..." styleClass="stat-value"/>
                        </VBox>
                        <VBox prefWidth="280" spacing="10" styleClass="stat-card-users">
                            <Label text="ðŸ‘¥ KHÃCH HÃ€NG" styleClass="stat-label"/>
                            <Label fx:id="lblDashUsers" text="Loading..." styleClass="stat-value"/>
                        </VBox>
                    </HBox>
                    
                    <VBox styleClass="card-container" VBox.vgrow="ALWAYS" spacing="20">
                        <Label text="ðŸ“ˆ Biá»ƒu Ä‘á»“ doanh thu theo thá»i gian" styleClass="label-title dashboard-chart-title"/>
                        <BarChart fx:id="revenueChart" styleClass="chart-transparent">
                            <xAxis><CategoryAxis label="Thá»i gian" /></xAxis>
                            <yAxis><NumberAxis label="VND" /></yAxis>
                        </BarChart>
                    </VBox>
                </VBox>
            </Tab>
            
            <Tab text="ðŸ›ï¸ Quáº£n lÃ½ Sáº£n pháº©m">
                <VBox spacing="20.0" styleClass="section-container">
                    <Label text="ðŸ›ï¸ Quáº£n lÃ½ Sáº£n pháº©m" styleClass="label-title section-title"/>
                    
                    <VBox styleClass="card-container" spacing="20">
                        <Label text="ðŸ“ ThÃ´ng tin sáº£n pháº©m" styleClass="label-title section-title-medium"/>
                        <HBox spacing="20.0" alignment="TOP_LEFT">
                            <VBox spacing="12.0" prefWidth="220">
                                <Label text="TÃªn sáº£n pháº©m:" styleClass="label-subtitle form-label-bold"/>
                                <TextField fx:id="txtName" promptText="Nháº­p tÃªn sáº£n pháº©m" prefWidth="220.0"/>
                                <Label text="GiÃ¡ tiá»n (VND):" styleClass="label-subtitle form-label-bold"/>
                                <TextField fx:id="txtPrice" promptText="Nháº­p giÃ¡ tiá»n" />
                            </VBox>
                            <VBox spacing="12.0" prefWidth="220">
                                <Label text="Danh má»¥c:" styleClass="label-subtitle form-label-bold"/>
                                <TextField fx:id="txtCategory" promptText="Ão/Quáº§n/GiÃ y" />
                                <Label text="Giá»›i tÃ­nh:" styleClass="label-subtitle form-label-bold"/>
                                <TextField fx:id="txtGender" promptText="Nam/Ná»¯/Tráº» em" />
                            </VBox>
                            <VBox spacing="12.0" prefWidth="220">
                                <Label text="Sá»‘ lÆ°á»£ng kho:" styleClass="label-subtitle form-label-bold"/>
                                <TextField fx:id="txtQuantity" promptText="Sá»‘ lÆ°á»£ng" />
                                <Label text="TÃªn file áº£nh:" styleClass="label-subtitle form-label-bold"/>
                                <HBox spacing="8.0">
                                    <TextField fx:id="txtImage" HBox.hgrow="ALWAYS" promptText="TÃªn file áº£nh"/>
                                    <Button text="ðŸ“ Chá»n" onAction="#handleChooseImage" style="-fx-background-color: white; -fx-text-fill: #1C2434; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 8 15; -fx-font-size: 13px; -fx-border-color: #CBD5E1; -fx-border-width: 1.5; -fx-border-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.05), 4, 0, 0, 1); -fx-cursor: hand;"/>
                                </HBox>
                            </VBox>
                            <VBox spacing="12.0" alignment="CENTER" prefWidth="150">
                                <Label text="Xem trÆ°á»›c áº£nh:" styleClass="label-subtitle form-label-bold"/>
                                <ImageView fx:id="imgPreview" fitHeight="100.0" fitWidth="100.0" styleClass="image-preview-view"/>
                                <Label fx:id="lblImageName" styleClass="image-preview-label"/>
                            </VBox>
                            <VBox spacing="12.0" HBox.hgrow="ALWAYS">
                                <Label text="MÃ´ táº£ sáº£n pháº©m:" styleClass="label-subtitle form-label-bold"/>
                                <TextField fx:id="txtDescription" promptText="Nháº­p mÃ´ táº£ chi tiáº¿t..." HBox.hgrow="ALWAYS"/>
                                <HBox spacing="12.0" alignment="BOTTOM_RIGHT" VBox.vgrow="ALWAYS">
                                    <Button onAction="#handleAddProduct" text="âž• THÃŠM" style="-fx-background-color: #10B981; -fx-text-fill: white; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 10 20; -fx-font-size: 13px; -fx-effect: dropshadow(three-pass-box, rgba(16, 185, 129, 0.4), 8, 0, 0, 3); -fx-cursor: hand;"/>
                                    <Button onAction="#handleUpdateProduct" text="âœï¸ Sá»¬A" style="-fx-background-color: #F59E0B; -fx-text-fill: white; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 10 20; -fx-font-size: 13px; -fx-effect: dropshadow(three-pass-box, rgba(245, 158, 11, 0.4), 8, 0, 0, 3); -fx-cursor: hand;"/>
                                    <Button onAction="#handleDeleteProduct" text="ðŸ—‘ï¸ XÃ“A" style="-fx-background-color: #EF4444; -fx-text-fill: white; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 10 20; -fx-font-size: 13px; -fx-effect: dropshadow(three-pass-box, rgba(239, 68, 68, 0.4), 8, 0, 0, 3); -fx-cursor: hand;"/>
                                    <Button onAction="#handleClearInput" text="ðŸ”„ Má»›i" style="-fx-background-color: white; -fx-text-fill: #1C2434; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 10 20; -fx-font-size: 13px; -fx-border-color: #CBD5E1; -fx-border-width: 1.5; -fx-border-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.05), 4, 0, 0, 1); -fx-cursor: hand;"/>
                                </HBox>
                            </VBox>
                        </HBox>
                    </VBox>
                    
                    <VBox styleClass="card-container" spacing="15">
                        <HBox alignment="CENTER_LEFT" spacing="15.0">
                            <Label text="ðŸ” TÃ¬m kiáº¿m:" styleClass="search-label"/>
                            <TextField fx:id="txtSearchProduct" promptText="TÃ¬m theo tÃªn, mÃ£ sáº£n pháº©m..." HBox.hgrow="ALWAYS" styleClass="search-field"/>
                            <Label text="ðŸ“‚ Lá»c danh má»¥c:" styleClass="search-label"/>
                            <ComboBox fx:id="cbFilterCategory" prefWidth="180.0" />
                        </HBox>
                        
                        <TableView fx:id="tableProduct" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="colId" text="ID" prefWidth="60.0"/>
                                <TableColumn fx:id="colName" text="TÃªn Sáº£n Pháº©m" prefWidth="280.0"/>
                                <TableColumn fx:id="colPrice" text="GiÃ¡ (VND)" prefWidth="120.0"/>
                                <TableColumn fx:id="colQuantity" text="Kho" prefWidth="90.0"/>
                                <TableColumn fx:id="colCategory" text="Danh má»¥c" prefWidth="120.0"/>
                                <TableColumn fx:id="colImage" text="áº¢nh" prefWidth="180.0"/>
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>
            </Tab>
            
            <Tab text="ðŸ“¦ ÄÆ¡n hÃ ng">
                <VBox spacing="25.0" styleClass="section-container-large">
                    <Label text="ðŸ“¦ Quáº£n lÃ½ ÄÆ¡n hÃ ng" styleClass="label-title section-title"/>
                    <VBox spacing="15.0" styleClass="card-container" VBox.vgrow="ALWAYS">
                        <HBox spacing="12.0" alignment="CENTER_LEFT">
                            <Button onAction="#handleApproveOrder" text="âœ… Duyá»‡t Ä‘Æ¡n" style="-fx-background-color: #10B981; -fx-text-fill: white; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 10 20; -fx-font-size: 13px; -fx-effect: dropshadow(three-pass-box, rgba(16, 185, 129, 0.4), 8, 0, 0, 3); -fx-cursor: hand;"/>
                            <Button onAction="#handleCancelOrder" text="âŒ Há»§y Ä‘Æ¡n" style="-fx-background-color: #EF4444; -fx-text-fill: white; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 10 20; -fx-font-size: 13px; -fx-effect: dropshadow(three-pass-box, rgba(239, 68, 68, 0.4), 8, 0, 0, 3); -fx-cursor: hand;"/>
                            <Button onAction="#handleRefreshOrders" text="ðŸ”„ Táº£i láº¡i" style="-fx-background-color: white; -fx-text-fill: #1C2434; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 10 20; -fx-font-size: 13px; -fx-border-color: #CBD5E1; -fx-border-width: 1.5; -fx-border-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.05), 4, 0, 0, 1); -fx-cursor: hand;"/>
                            <HBox HBox.hgrow="ALWAYS" />
                            <Label text="ðŸ” TÃ¬m kiáº¿m:" styleClass="search-label-small"/>
                            <TextField fx:id="txtSearchOrder" promptText="TÃ¬m theo mÃ£ Ä‘Æ¡n, user ID, tráº¡ng thÃ¡i..." styleClass="search-field-medium" />
                        </HBox>
                        <TableView fx:id="tableOrder" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="colOrderId" text="MÃ£ ÄH" prefWidth="100"/>
                                <TableColumn fx:id="colUserId" text="User ID" prefWidth="100"/>
                                <TableColumn fx:id="colTotal" text="Tá»•ng tiá»n (VND)" prefWidth="150"/>
                                <TableColumn fx:id="colStatus" text="Tráº¡ng thÃ¡i" prefWidth="150"/>
                                <TableColumn fx:id="colDate" text="NgÃ y Ä‘áº·t" prefWidth="150"/>
                                <TableColumn fx:id="colPayment" text="PhÆ°Æ¡ng thá»©c" prefWidth="150"/>
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>
            </Tab>
            
            <Tab text="ðŸ‘¥ NgÆ°á»i dÃ¹ng">
                <VBox spacing="25.0" styleClass="section-container-large">
                    <Label text="ðŸ‘¥ Quáº£n lÃ½ NgÆ°á»i dÃ¹ng" styleClass="label-title section-title"/>
                    <VBox spacing="15.0" styleClass="card-container" VBox.vgrow="ALWAYS">
                        <HBox spacing="12.0" alignment="CENTER_LEFT">
                            <Button onAction="#handleLockUser" text="ðŸ”’ KhÃ³a / Má»Ÿ khÃ³a" style="-fx-background-color: #F59E0B; -fx-text-fill: white; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 10 20; -fx-font-size: 13px; -fx-effect: dropshadow(three-pass-box, rgba(245, 158, 11, 0.4), 8, 0, 0, 3); -fx-cursor: hand;"/>
                            <Button onAction="#handleDeleteUser" text="ðŸ—‘ï¸ XÃ³a tÃ i khoáº£n" style="-fx-background-color: #EF4444; -fx-text-fill: white; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 10 20; -fx-font-size: 13px; -fx-effect: dropshadow(three-pass-box, rgba(239, 68, 68, 0.4), 8, 0, 0, 3); -fx-cursor: hand;"/>
                            <Button onAction="#handleRefreshUsers" text="ðŸ”„ Táº£i láº¡i" style="-fx-background-color: white; -fx-text-fill: #1C2434; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 10 20; -fx-font-size: 13px; -fx-border-color: #CBD5E1; -fx-border-width: 1.5; -fx-border-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.05), 4, 0, 0, 1); -fx-cursor: hand;"/>
                        </HBox>
                        <TableView fx:id="tableUser" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="colUserTableId" text="ID" prefWidth="80"/>
                                <TableColumn fx:id="colUsername" text="TÃªn Ä‘Äƒng nháº­p" prefWidth="150"/>
                                <TableColumn fx:id="colEmail" text="Email" prefWidth="250"/>
                                <TableColumn fx:id="colPhone" text="Sá»‘ Ä‘iá»‡n thoáº¡i" prefWidth="150"/>
                                <TableColumn fx:id="colTotalOrders" text="Tá»•ng Ä‘Æ¡n hÃ ng" prefWidth="130"/>
                                <TableColumn fx:id="colUserStatus" text="Tráº¡ng thÃ¡i" prefWidth="150"/>
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>
            </Tab>
            
            <Tab text="â­ ÄÃ¡nh giÃ¡">
                <VBox spacing="25.0" styleClass="section-container-large">
                    <Label text="â­ Pháº£n há»“i khÃ¡ch hÃ ng" styleClass="label-title section-title"/>
                    <VBox spacing="15.0" styleClass="card-container" VBox.vgrow="ALWAYS">
                        <HBox spacing="12.0" alignment="CENTER_LEFT">
                            <Button onAction="#handleDeleteReview" text="ðŸ—‘ï¸ XÃ³a Ä‘Ã¡nh giÃ¡" style="-fx-background-color: #EF4444; -fx-text-fill: white; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 10 20; -fx-font-size: 13px; -fx-effect: dropshadow(three-pass-box, rgba(239, 68, 68, 0.4), 8, 0, 0, 3); -fx-cursor: hand;"/>
                            <Button onAction="#handleRefreshReviews" text="ðŸ”„ Táº£i láº¡i" style="-fx-background-color: white; -fx-text-fill: #1C2434; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 10 20; -fx-font-size: 13px; -fx-border-color: #CBD5E1; -fx-border-width: 1.5; -fx-border-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.05), 4, 0, 0, 1); -fx-cursor: hand;"/>
                        </HBox>
                        <TableView fx:id="tableReview" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="colReviewId" text="ID" prefWidth="60"/>
                                <TableColumn fx:id="colReviewUser" text="NgÆ°á»i dÃ¹ng" prefWidth="150"/>
                                <TableColumn fx:id="colReviewProduct" text="Sáº£n pháº©m" prefWidth="200"/>
                                <TableColumn fx:id="colReviewRating" text="ÄÃ¡nh giÃ¡" prefWidth="100"/>
                                <TableColumn fx:id="colReviewComment" text="Ná»™i dung Ä‘Ã¡nh giÃ¡" prefWidth="350"/>
                                <TableColumn fx:id="colReviewDate" text="NgÃ y Ä‘Ã¡nh giÃ¡" prefWidth="150"/>
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>
            </Tab>
            
            <Tab text="ðŸŽ« Voucher">
                <VBox spacing="25.0" styleClass="section-container-large">
                    <Label text="ðŸŽ« Quáº£n lÃ½ MÃ£ giáº£m giÃ¡" styleClass="label-title section-title"/>
                    <HBox spacing="25.0" VBox.vgrow="ALWAYS">
                        <VBox spacing="18.0" styleClass="card-container" prefWidth="350">
                            <Label text="âž• Táº¡o mÃ£ giáº£m giÃ¡ má»›i" styleClass="label-title section-title-medium"/>
                            <VBox spacing="12.0">
                                <Label text="MÃ£ Code:" styleClass="label-subtitle form-label-bold"/>
                                <TextField fx:id="txtVoucherCode" promptText="Nháº­p mÃ£ code (VD: SALE2024)"/>
                            </VBox>
                            <VBox spacing="12.0">
                                <Label text="Pháº§n trÄƒm giáº£m (%):" styleClass="label-subtitle form-label-bold"/>
                                <TextField fx:id="txtVoucherPercent" promptText="Nháº­p % giáº£m (VD: 10)"/>
                            </VBox>
                            <VBox spacing="12.0">
                                <Label text="Sá»‘ lÆ°á»£ng voucher:" styleClass="label-subtitle form-label-bold"/>
                                <TextField fx:id="txtVoucherQty" promptText="Nháº­p sá»‘ lÆ°á»£ng"/>
                            </VBox>
                            <VBox spacing="12.0">
                                <Label text="NgÃ y háº¿t háº¡n:" styleClass="label-subtitle form-label-bold"/>
                                <DatePicker fx:id="dpVoucherDate" styleClass="date-picker-wide"/>
                            </VBox>
                            <Button onAction="#handleAddVoucher" text="âœ¨ Táº¡o Voucher" style="-fx-background-color: #3C50E0; -fx-text-fill: white; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 12 20; -fx-font-size: 14px; -fx-effect: dropshadow(three-pass-box, rgba(60, 80, 224, 0.4), 8, 0, 0, 3); -fx-cursor: hand;" maxWidth="Infinity"/>
                        </VBox>
                        
                        <VBox spacing="15.0" styleClass="card-container" HBox.hgrow="ALWAYS">
                            <HBox spacing="12.0" alignment="CENTER_LEFT">
                                <Label text="ðŸ“‹ Danh sÃ¡ch Voucher" styleClass="label-title section-title-medium"/>
                                <HBox HBox.hgrow="ALWAYS"/>
                                <Button onAction="#handleDeleteVoucher" text="ðŸ—‘ï¸ XÃ³a mÃ£ chá»n" style="-fx-background-color: #EF4444; -fx-text-fill: white; -fx-background-radius: 8; -fx-font-weight: 600; -fx-padding: 10 20; -fx-font-size: 13px; -fx-effect: dropshadow(three-pass-box, rgba(239, 68, 68, 0.4), 8, 0, 0, 3); -fx-cursor: hand;"/>
                            </HBox>
                            <TableView fx:id="tableVoucher" VBox.vgrow="ALWAYS">
                                <columns>
                                    <TableColumn fx:id="colVoucherCode" text="MÃ£ Code" prefWidth="200"/>
                                    <TableColumn fx:id="colVoucherPercent" text="Giáº£m (%)" prefWidth="120"/>
                                    <TableColumn fx:id="colVoucherQty" text="Sá»‘ lÆ°á»£ng" prefWidth="150"/>
                                    <TableColumn fx:id="colVoucherDate" text="NgÃ y háº¿t háº¡n" prefWidth="200"/>
                                </columns>
                            </TableView>
                        </VBox>
                    </HBox>
                </VBox>
            </Tab>
            
        </TabPane>
    </center>
</BorderPane>